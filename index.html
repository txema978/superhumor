<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mi App con Supabase</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .preview { max-width: 200px; margin-top: 10px; }
  </style>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
  <h1>Subir imágenes a Supabase</h1>
  
  <input type="file" id="fileInput">
  <button onclick="uploadImage()">Subir</button>
  
  <div id="output"></div>
  
  <script>
    const SUPABASE_URL = "https://qjmugmnrgxccliyrlwfz.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFqbXVnbW5yZ3hjY2xpeXJsd2Z6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU3ODQzOTIsImV4cCI6MjA3MTM2MDM5Mn0.ZMM9eNBj4HQxJqZ-RKDS8YLCL20xf3geyHnLm1kGUPo";

    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    async function uploadImage() {
      const file = document.getElementById("fileInput").files[0];
      if (!file) {
        alert("Selecciona un archivo primero.");
        return;
      }

      const filePath = `uploads/${Date.now()}_${file.name}`;

      let { data, error } = await supabase
        .storage
        .from("imagenes")
        .upload(filePath, file);

      if (error) {
        document.getElementById("output").innerHTML = "❌ Error: " + error.message;
      } else {
        const url = `${SUPABASE_URL}/storage/v1/object/public/imagenes/${filePath}`;
        document.getElementById("output").innerHTML = 
          `✅ Subido con éxito: <a href="${url}" target="_blank">${url}</a><br><img src="${url}" class="preview">`;
      }
    }
  </script>
</body>
</html>